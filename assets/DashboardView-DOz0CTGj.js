import{E as Yt}from"./element-plus-T7eq0npu.js";import{aP as Wt,r as S,c as ot,x as f,y as x,z as t,P as p,L as $,O as U,Q as ht,ac as kt,aX as Et,o as gt,q as Zt,D as at,V as Qt,R as Gt,u as a,C as st,K as Xt,al as Jt}from"./vue-vendor-R8HMg95E.js";import{c as Z,s as Ot,_ as te,a as ee}from"./index-CYC8e9-T.js";import{C as $t}from"./chart-qI8C9904.js";import"./vendor-DTV-MYIR.js";const ae=Wt("dashboard",()=>{const Q=S(!1),V=S({totalApiKeys:0,activeApiKeys:0,totalAccounts:0,normalAccounts:0,abnormalAccounts:0,pausedAccounts:0,activeAccounts:0,rateLimitedAccounts:0,accountsByPlatform:{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:0,totalRequests:0,todayTokens:0,todayInputTokens:0,todayOutputTokens:0,totalTokens:0,totalInputTokens:0,totalOutputTokens:0,totalCacheCreateTokens:0,totalCacheReadTokens:0,todayCacheCreateTokens:0,todayCacheReadTokens:0,systemRPM:0,systemTPM:0,realtimeRPM:0,realtimeTPM:0,metricsWindow:5,isHistoricalMetrics:!1,systemStatus:"æ­£å¸¸",uptime:0,systemTimezone:8}),q=S({todayCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:{totalCost:0,formatted:{totalCost:"$0.000000"}}}),z=S([]),o=S([]),ut=S([]),X=S({platforms:{claude:{updatedAt:null,overall:null,groups:[]},openai:{updatedAt:null,overall:null,groups:[]}}}),W=S({data:[],topApiKeys:[],totalApiKeys:0}),N=S({data:[],topAccounts:[],totalAccounts:0,group:"claude",groupLabel:"Claudeè´¦æˆ·"}),s=S({type:"preset",preset:"7days",customStart:"",customEnd:"",customRange:null,presetOptions:[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}]}),d=S("day"),P=S("requests"),J=S("claude"),nt=S([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),tt=ot(()=>{const y=V.value.uptime,n=Math.floor(y/86400),u=Math.floor(y%86400/3600),c=Math.floor(y%3600/60);return n>0?`${n}å¤© ${u}å°æ—¶`:u>0?`${u}å°æ—¶ ${c}åˆ†é’Ÿ`:`${c}åˆ†é’Ÿ`});function _(y,n=!0){const u=y.getFullYear(),c=y.getMonth(),l=y.getDate();return n?new Date(Date.UTC(u,c,l-1,16,0,0,0)):new Date(Date.UTC(u,c,l,15,59,59,999))}async function St(y=null){Q.value=!0;try{let n={today:"today",all:"all"};y&&(n={today:{today:"today",all:"today"},"7days":{today:"7days",all:"7days"},monthly:{today:"monthly",all:"monthly"},all:{today:"today",all:"all"}}[y]||n);const[u,c,l,i]=await Promise.all([Z.get("/admin/dashboard"),Z.get(`/admin/usage-costs?period=${n.today}`),Z.get(`/admin/usage-costs?period=${n.all}`),Z.get("/admin/account-limits/summary")]);if(u.success){const r=u.data.overview||{},m=u.data.recentActivity||{},I=u.data.systemAverages||{},w=u.data.realtimeMetrics||{},O=u.data.systemHealth||{};V.value={totalApiKeys:r.totalApiKeys||0,activeApiKeys:r.activeApiKeys||0,totalAccounts:r.totalAccounts||r.totalClaudeAccounts||0,normalAccounts:r.normalAccounts||0,abnormalAccounts:r.abnormalAccounts||0,pausedAccounts:r.pausedAccounts||0,activeAccounts:r.activeAccounts||r.activeClaudeAccounts||0,rateLimitedAccounts:r.rateLimitedAccounts||r.rateLimitedClaudeAccounts||0,accountsByPlatform:r.accountsByPlatform||{claude:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},"claude-console":{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},gemini:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},azure_openai:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0},bedrock:{total:0,normal:0,abnormal:0,paused:0,rateLimited:0}},todayRequests:m.requestsToday||0,totalRequests:r.totalRequestsUsed||0,todayTokens:m.tokensToday||0,todayInputTokens:m.inputTokensToday||0,todayOutputTokens:m.outputTokensToday||0,totalTokens:r.totalTokensUsed||0,totalInputTokens:r.totalInputTokensUsed||0,totalOutputTokens:r.totalOutputTokensUsed||0,totalCacheCreateTokens:r.totalCacheCreateTokensUsed||0,totalCacheReadTokens:r.totalCacheReadTokensUsed||0,todayCacheCreateTokens:m.cacheCreateTokensToday||0,todayCacheReadTokens:m.cacheReadTokensToday||0,systemRPM:I.rpm||0,systemTPM:I.tpm||0,realtimeRPM:w.rpm||0,realtimeTPM:w.tpm||0,metricsWindow:w.windowMinutes||5,isHistoricalMetrics:w.isHistorical||!1,systemStatus:O.redisConnected?"æ­£å¸¸":"å¼‚å¸¸",uptime:O.uptime||0,systemTimezone:u.data.systemTimezone||8}}c.success&&l.success&&(q.value={todayCosts:c.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}},totalCosts:l.data.totalCosts||{totalCost:0,formatted:{totalCost:"$0.000000"}}}),i&&i.success&&(X.value=i.data||{platforms:{claude:{updatedAt:null,overall:null,groups:[]},openai:{updatedAt:null,overall:null,groups:[]}}})}catch(n){console.error("åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:",n)}finally{Q.value=!1}}async function At(y=!1){try{const n=y?"/admin/account-limits/summary?refresh=true":"/admin/account-limits/summary",u=await Z.get(n);u&&u.success&&(X.value=u.data||{platforms:{claude:{updatedAt:null,overall:null,groups:[]},openai:{updatedAt:null,overall:null,groups:[]}}})}catch(n){console.error("åŠ è½½åˆ†ç»„çª—å£/é™é¢æ±‡æ€»å¤±è´¥:",n)}}async function _t(y=7,n="day"){try{let u="/admin/usage-trend?";if(n==="hour")if(u+="granularity=hour",s.value.customRange&&s.value.customRange.length===2){const l=i=>{const[m,I]=i.split(" "),[w,O,B]=m.split("-").map(Number),[M,K,E]=I.split(":").map(Number);return new Date(Date.UTC(w,O-1,B,M-8,K,E)).toISOString()};u+=`&startDate=${encodeURIComponent(l(s.value.customRange[0]))}`,u+=`&endDate=${encodeURIComponent(l(s.value.customRange[1]))}`}else{const l=new Date;let i,r;if(s.value.type==="preset")switch(s.value.preset){case"last24h":{r=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const m=new Date;m.setDate(m.getDate()-1),i=_(m,!0),r=_(m,!1);break}case"dayBefore":{const m=new Date;m.setDate(m.getDate()-2),i=_(m,!0),r=_(m,!1);break}default:i=new Date(l.getTime()-24*60*60*1e3),r=l}else i=new Date(l.getTime()-y*24*60*60*1e3),r=l;u+=`&startDate=${encodeURIComponent(i.toISOString())}`,u+=`&endDate=${encodeURIComponent(r.toISOString())}`}else u+=`granularity=day&days=${y}`;const c=await Z.get(u);c.success&&(o.value=c.data)}catch(u){console.error("åŠ è½½ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",u)}}async function Dt(y="daily"){try{let n=`/admin/model-stats?period=${y}`;if(s.value.type==="custom"||d.value==="hour"){if(s.value.customRange&&s.value.customRange.length===2){const c=l=>{const[r,m]=l.split(" "),[I,w,O]=r.split("-").map(Number),[B,M,K]=m.split(":").map(Number);return new Date(Date.UTC(I,w-1,O,B-8,M,K)).toISOString()};n+=`&startDate=${encodeURIComponent(c(s.value.customRange[0]))}`,n+=`&endDate=${encodeURIComponent(c(s.value.customRange[1]))}`}else if(d.value==="hour"&&s.value.type==="preset"){const c=new Date;let l,i;switch(s.value.preset){case"last24h":{i=new Date(c),l=new Date(c.getTime()-24*60*60*1e3);break}case"yesterday":{const r=new Date;r.setDate(r.getDate()-1),l=_(r,!0),i=_(r,!1);break}case"dayBefore":{const r=new Date;r.setDate(r.getDate()-2),l=_(r,!0),i=_(r,!1);break}default:l=new Date(c.getTime()-24*60*60*1e3),i=c}n+=`&startDate=${encodeURIComponent(l.toISOString())}`,n+=`&endDate=${encodeURIComponent(i.toISOString())}`}}else if(s.value.type==="preset"&&d.value==="day"){const c=new Date;let l,i;const r=s.value.presetOptions.find(m=>m.value===s.value.preset);if(r){if(s.value.preset==="today")l=_(c,!0),i=_(c,!1);else{const m=new Date;m.setDate(m.getDate()-(r.days-1)),l=_(m,!0),i=_(c,!1)}n+=`&startDate=${encodeURIComponent(l.toISOString())}`,n+=`&endDate=${encodeURIComponent(i.toISOString())}`}}const u=await Z.get(n);u.success&&(ut.value=u.data)}catch(n){console.error("åŠ è½½æ¨¡å‹ç»Ÿè®¡å¤±è´¥:",n)}}async function Ct(y="requests"){try{let n="/admin/api-keys-usage-trend?",u=7;if(d.value==="hour")if(n+="granularity=hour",s.value.customRange&&s.value.customRange.length===2){const l=i=>{const[m,I]=i.split(" "),[w,O,B]=m.split("-").map(Number),[M,K,E]=I.split(":").map(Number);return new Date(Date.UTC(w,O-1,B,M-8,K,E)).toISOString()};n+=`&startDate=${encodeURIComponent(l(s.value.customRange[0]))}`,n+=`&endDate=${encodeURIComponent(l(s.value.customRange[1]))}`}else{const l=new Date;let i,r;if(s.value.type==="preset")switch(s.value.preset){case"last24h":{r=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const m=new Date;m.setDate(m.getDate()-1),i=_(m,!0),r=_(m,!1);break}case"dayBefore":{const m=new Date;m.setDate(m.getDate()-2),i=_(m,!0),r=_(m,!1);break}default:i=new Date(l.getTime()-24*60*60*1e3),r=l}else i=new Date(l.getTime()-24*60*60*1e3),r=l;n+=`&startDate=${encodeURIComponent(i.toISOString())}`,n+=`&endDate=${encodeURIComponent(r.toISOString())}`}else u=s.value.type==="preset"?s.value.preset==="today"?1:s.value.preset==="7days"?7:30:lt(s.value.customStart,s.value.customEnd),n+=`granularity=day&days=${u}`;n+=`&metric=${y}`;const c=await Z.get(n);c.success&&(W.value={data:c.data||[],topApiKeys:c.topApiKeys||[],totalApiKeys:c.totalApiKeys||0})}catch(n){console.error("åŠ è½½API Keysè¶‹åŠ¿å¤±è´¥:",n)}}async function ft(y=J.value){try{let n="/admin/account-usage-trend?",u=7;if(d.value==="hour")if(n+="granularity=hour",s.value.customRange&&s.value.customRange.length===2){const l=i=>{const[m,I]=i.split(" "),[w,O,B]=m.split("-").map(Number),[M,K,E]=I.split(":").map(Number);return new Date(Date.UTC(w,O-1,B,M-8,K,E)).toISOString()};n+=`&startDate=${encodeURIComponent(l(s.value.customRange[0]))}`,n+=`&endDate=${encodeURIComponent(l(s.value.customRange[1]))}`}else{const l=new Date;let i,r;if(s.value.type==="preset")switch(s.value.preset){case"last24h":{r=new Date(l),i=new Date(l.getTime()-24*60*60*1e3);break}case"yesterday":{const m=new Date;m.setDate(m.getDate()-1),i=_(m,!0),r=_(m,!1);break}case"dayBefore":{const m=new Date;m.setDate(m.getDate()-2),i=_(m,!0),r=_(m,!1);break}default:i=new Date(l.getTime()-24*60*60*1e3),r=l}else i=new Date(l.getTime()-24*60*60*1e3),r=l;n+=`&startDate=${encodeURIComponent(i.toISOString())}`,n+=`&endDate=${encodeURIComponent(r.toISOString())}`}else u=s.value.type==="preset"?s.value.preset==="today"?1:s.value.preset==="7days"?7:30:lt(s.value.customStart,s.value.customEnd),n+=`granularity=day&days=${u}`;n+=`&group=${y}`;const c=await Z.get(n);c.success&&(N.value={data:c.data||[],topAccounts:c.topAccounts||[],totalAccounts:c.totalAccounts||0,group:c.group||y,groupLabel:c.groupLabel||""})}catch(n){console.error("åŠ è½½è´¦å·ä½¿ç”¨è¶‹åŠ¿å¤±è´¥:",n)}}function et(y){s.value.type="preset",s.value.preset=y;const n=s.value.presetOptions.find(u=>u.value===y);if(n){const u=new Date;let c,l;if(d.value==="hour")switch(y){case"last24h":{l=new Date(u),c=new Date(u.getTime()-24*60*60*1e3);break}case"yesterday":{const i=new Date;i.setDate(i.getDate()-1),c=_(i,!0),l=_(i,!1);break}case"dayBefore":{const i=new Date;i.setDate(i.getDate()-2),c=_(i,!0),l=_(i,!1);break}}else c=new Date(u),l=new Date(u),y==="today"?(c.setHours(0,0,0,0),l.setHours(23,59,59,999)):(c.setDate(u.getDate()-(n.days-1)),c.setHours(0,0,0,0),l.setHours(23,59,59,999));if(s.value.customStart=c.toISOString().split("T")[0],s.value.customEnd=l.toISOString().split("T")[0],d.value==="hour"&&(y==="yesterday"||y==="dayBefore")){const i=new Date;y==="yesterday"?i.setDate(i.getDate()-1):i.setDate(i.getDate()-2);const r=i.getFullYear(),m=String(i.getMonth()+1).padStart(2,"0"),I=String(i.getDate()).padStart(2,"0");s.value.customRange=[`${r}-${m}-${I} 00:00:00`,`${r}-${m}-${I} 23:59:59`]}else{const i=r=>{const w=new Date(r.getTime()+288e5),O=w.getUTCFullYear(),B=String(w.getUTCMonth()+1).padStart(2,"0"),M=String(w.getUTCDate()).padStart(2,"0"),K=String(w.getUTCHours()).padStart(2,"0"),E=String(w.getUTCMinutes()).padStart(2,"0"),D=String(w.getUTCSeconds()).padStart(2,"0");return`${O}-${B}-${M} ${K}:${E}:${D}`};s.value.customRange=[i(c),i(l)]}}ct()}function Rt(y){if(y&&y.length===2){s.value.type="custom",s.value.preset="",s.value.customRange=y,s.value.customStart=y[0].split(" ")[0],s.value.customEnd=y[1].split(" ")[0];const n=l=>{const[i,r]=l.split(" "),[m,I,w]=i.split("-").map(Number),[O,B,M]=r.split(":").map(Number);return new Date(m,I-1,w,O,B,M)},u=n(y[0]),c=n(y[1]);if(d.value==="hour"){if((c-u)/36e5>24){Ot("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶","warning");return}}else if(Math.ceil((c-u)/864e5)+1>31){Ot("æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡ 31 å¤©","warning");return}ct()}else y===null&&et(d.value==="hour"?"last24h":"7days")}function Pt(y){if(d.value=y,y==="hour"){if(s.value.presetOptions=[{value:"last24h",label:"è¿‘24å°æ—¶",hours:24},{value:"yesterday",label:"æ˜¨å¤©",hours:24},{value:"dayBefore",label:"å‰å¤©",hours:24}],s.value.type==="custom"&&s.value.customRange&&s.value.customRange.length===2){const n=new Date(s.value.customRange[0]);if((new Date(s.value.customRange[1])-n)/(1e3*60*60)>24){Ot("å°æ—¶ç²’åº¦ä¸‹æ—¥æœŸèŒƒå›´ä¸èƒ½è¶…è¿‡24å°æ—¶ï¼Œå·²åˆ‡æ¢åˆ°è¿‘24å°æ—¶","warning"),et("last24h");return}}if(["today","7days","30days"].includes(s.value.preset)){et("last24h");return}}else if(s.value.presetOptions=[{value:"today",label:"ä»Šæ—¥",days:1},{value:"7days",label:"7å¤©",days:7},{value:"30days",label:"30å¤©",days:30}],["last24h","yesterday","dayBefore"].includes(s.value.preset)){et("7days");return}ct()}async function ct(){let y,n="monthly";if(s.value.type==="preset"){const u=s.value.presetOptions.find(c=>c.value===s.value.preset);d.value==="hour"?(y=1,n="daily"):(y=u?u.days:7,s.value.preset==="today"?n="daily":n="monthly")}else{if(d.value==="hour"){const u=new Date(s.value.customRange[0]),c=new Date(s.value.customRange[1]),l=Math.ceil((c-u)/(1e3*60*60));y=Math.ceil(l/24)||1}else y=lt(s.value.customStart,s.value.customEnd);n="daily"}await Promise.all([_t(y,d.value),Dt(n),Ct(P.value),ft(J.value)])}function xt(y){return J.value=y,ft(y)}function lt(y,n){if(!y||!n)return 7;const u=new Date(y),c=new Date(n),l=Math.abs(c-u);return Math.ceil(l/(1e3*60*60*24))||7}function vt(y){return y>new Date}return{loading:Q,dashboardData:V,groupLimitsSummary:X,costsData:q,modelStats:z,trendData:o,dashboardModelStats:ut,apiKeysTrendData:W,accountUsageTrendData:N,dateFilter:s,trendGranularity:d,apiKeysTrendMetric:P,accountUsageGroup:J,defaultTime:nt,formattedUptime:tt,loadDashboardData:St,loadGroupLimitsSummary:At,loadUsageTrend:_t,loadModelStats:Dt,loadApiKeysTrend:Ct,loadAccountUsageTrend:ft,setDateFilterPreset:et,onCustomDateRangeChange:Rt,setTrendGranularity:Pt,refreshChartsData:ct,setAccountUsageGroup:xt,disabledDate:vt}}),se={class:"mb-4 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-900/40 dark:bg-blue-900/20 sm:mb-6 sm:p-4"},oe={class:"mb-2 flex items-center justify-between"},ne={class:"flex items-center gap-2"},le=["disabled"],re={key:0,class:"flex flex-col gap-3"},ie={key:0,class:"text-xs text-gray-800 dark:text-gray-200"},de={key:1,class:"flex flex-col gap-1"},ue={class:"flex flex-wrap items-center gap-x-3 gap-y-2"},ce={key:0,class:"text-xs text-gray-700 dark:text-gray-300"},me={key:0,class:"mt-1 flex flex-wrap gap-2"},pe={class:"mr-1 font-medium text-gray-800 dark:text-gray-200"},ye={class:"text-gray-600 dark:text-gray-300"},ge={class:"text-gray-600 dark:text-gray-300"},fe={key:2,class:"flex flex-col gap-1"},xe={class:"flex flex-wrap items-center gap-x-3 gap-y-2"},ve={key:0,class:"text-xs text-gray-700 dark:text-gray-300"},be={key:0,class:"mt-1 flex flex-wrap gap-2"},he={class:"mr-1 font-medium text-gray-800 dark:text-gray-200"},ke={class:"text-gray-600 dark:text-gray-300"},_e={class:"text-gray-600 dark:text-gray-300"},De={key:1,class:"text-xs text-blue-700/80 dark:text-blue-200/80"},Ce={__name:"GroupLimitsBanner",props:{limits:{type:Object,default:()=>({platforms:{claude:null,openai:null}})},refreshing:{type:Boolean,default:!1},maxGroups:{type:Number,default:6}},emits:["refresh"],setup(Q){const V=Q,q=ot(()=>{var s,d;return((d=(s=V.limits)==null?void 0:s.platforms)==null?void 0:d.claude)||null}),z=ot(()=>{var s,d;return((d=(s=V.limits)==null?void 0:s.platforms)==null?void 0:d.openai)||null}),o=ot(()=>{var s;return((s=V.limits)==null?void 0:s.overall)||null}),ut=ot(()=>{const s=q.value,d=z.value,P=!!(s&&(s.overall&&s.overall.sampleCount>0||(s.groups||[]).length)),J=!!(d&&(d.overall&&d.overall.sampleCount>0||(d.groups||[]).length));return P||J}),X=ot(()=>{var d;return(((d=q.value)==null?void 0:d.groups)||[]).filter(P=>(P.sampleCount||0)>0).slice(0,V.maxGroups)}),W=ot(()=>{var d;return(((d=z.value)==null?void 0:d.groups)||[]).filter(P=>(P.sampleCount||0)>0).slice(0,V.maxGroups)});function N(s){return Number.isFinite(Number(s))?Math.round(Number(s)):0}return(s,d)=>(x(),f("div",se,[t("div",oe,[d[2]||(d[2]=t("div",{class:"text-sm font-semibold text-blue-800 dark:text-blue-200"}," è´¦å·åˆ†ç»„çª—å£/å‘¨é™ä½¿ç”¨æ¦‚è§ˆ ",-1)),t("div",ne,[t("button",{class:"rounded bg-blue-600 px-2 py-0.5 text-xs font-medium text-white hover:bg-blue-700 disabled:opacity-60",disabled:Q.refreshing,onClick:d[0]||(d[0]=P=>s.$emit("refresh"))},p(Q.refreshing?"åˆ·æ–°ä¸­â€¦":"åˆ·æ–°"),9,le),d[1]||(d[1]=t("div",{class:"text-[11px] text-blue-700/70 dark:text-blue-200/70"}," ä»…æ˜¾ç¤ºå·²è·å–åˆ°å¿«ç…§çš„æ•°æ® ",-1))])]),ut.value?(x(),f("div",re,[o.value?(x(),f("div",ie,[d[3]||(d[3]=U(" å…¨éƒ¨è´¦å·å¹³å‡ï¼š ",-1)),t("span",null,"5h "+p(N(o.value.fiveHourPercent))+"%",1),d[4]||(d[4]=t("span",{class:"mx-1 text-gray-400"},"/",-1)),t("span",null,"å‘¨ "+p(N(o.value.weekPercent))+"%",1)])):$("",!0),q.value?(x(),f("div",de,[t("div",ue,[d[5]||(d[5]=t("span",{class:"rounded bg-indigo-100 px-2 py-0.5 text-xs font-medium text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-200"},"Claude",-1)),q.value.overall&&q.value.overall.sampleCount>0?(x(),f("span",ce," å…¨éƒ¨å¹³å‡ï¼š5h "+p(N(q.value.overall.fiveHourPercent))+"% ï½œ å‘¨ "+p(N(q.value.overall.weekPercent))+"% ",1)):$("",!0)]),q.value.groups&&q.value.groups.length?(x(),f("div",me,[(x(!0),f(ht,null,kt(X.value,P=>(x(),f("div",{key:P.id,class:"rounded-md bg-white px-2 py-1 text-xs shadow-sm ring-1 ring-gray-200 dark:bg-gray-800 dark:ring-gray-700"},[t("span",pe,p(P.name),1),t("span",ye,"5h "+p(N(P.fiveHourPercent))+"%",1),d[6]||(d[6]=t("span",{class:"mx-1 text-gray-400"},"/",-1)),t("span",ge,"å‘¨ "+p(N(P.weekPercent))+"%",1)]))),128))])):$("",!0)])):$("",!0),z.value?(x(),f("div",fe,[t("div",xe,[d[7]||(d[7]=t("span",{class:"rounded bg-emerald-100 px-2 py-0.5 text-xs font-medium text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-200"},"OpenAI",-1)),z.value.overall&&z.value.overall.sampleCount>0?(x(),f("span",ve," å…¨éƒ¨å¹³å‡ï¼š5h "+p(N(z.value.overall.fiveHourPercent))+"% ï½œ å‘¨ "+p(N(z.value.overall.weekPercent))+"% ",1)):$("",!0)]),z.value.groups&&z.value.groups.length?(x(),f("div",be,[(x(!0),f(ht,null,kt(W.value,P=>(x(),f("div",{key:P.id,class:"rounded-md bg-white px-2 py-1 text-xs shadow-sm ring-1 ring-gray-200 dark:bg-gray-800 dark:ring-gray-700"},[t("span",he,p(P.name),1),t("span",ke,"5h "+p(N(P.fiveHourPercent))+"%",1),d[8]||(d[8]=t("span",{class:"mx-1 text-gray-400"},"/",-1)),t("span",_e,"å‘¨ "+p(N(P.weekPercent))+"%",1)]))),128))])):$("",!0)])):$("",!0)])):(x(),f("div",De," æš‚æ— å¯å±•ç¤ºçš„åˆ†ç»„çª—å£/é™é¢æ•°æ®ã€‚å¯ç‚¹å‡»â€œåˆ·æ–°â€å°è¯•è·å–æœ€æ–°å¿«ç…§ã€‚ "))]))}},we={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},Te={class:"stat-card"},$e={class:"flex items-center justify-between"},Se={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Ae={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Re={class:"stat-card"},Pe={class:"flex items-center justify-between"},Ue={class:"flex-1"},Ie={class:"flex flex-wrap items-baseline gap-x-2"},Be={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},Me={key:0,class:"flex items-center gap-2"},Oe=["title"],Ke={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Fe=["title"],Le={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},ze=["title"],Ne={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},He=["title"],Ee={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ge=["title"],qe={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ve=["title"],je={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ye=["title"],We={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Ze={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Qe={key:0,class:"text-red-600"},Xe={key:1,class:"text-gray-600 dark:text-gray-400"},Je={key:2,class:"text-yellow-600"},ta={class:"stat-card"},ea={class:"flex items-center justify-between"},aa={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 sm:text-3xl"},sa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},oa={class:"stat-card"},na={class:"flex items-center justify-between"},la={class:"text-2xl font-bold text-green-600 sm:text-3xl"},ra={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ia={class:"mb-4 grid grid-cols-1 gap-3 sm:mb-6 sm:grid-cols-2 sm:gap-4 md:mb-8 md:gap-6 lg:grid-cols-4"},da={class:"stat-card"},ua={class:"flex items-center justify-between"},ca={class:"mr-8 flex-1"},ma={class:"mb-2 flex flex-wrap items-baseline gap-2"},pa={class:"text-xl font-bold text-blue-600 sm:text-2xl md:text-3xl"},ya={class:"text-sm font-medium text-green-600"},ga={class:"text-xs text-gray-500 dark:text-gray-400"},fa={class:"flex flex-wrap items-center justify-between gap-x-4"},xa={class:"font-medium"},va={class:"font-medium"},ba={key:0,class:"text-purple-600"},ha={class:"font-medium"},ka={key:1,class:"text-purple-600"},_a={class:"font-medium"},Da={class:"stat-card"},Ca={class:"flex items-center justify-between"},wa={class:"mr-8 flex-1"},Ta={class:"mb-2 flex flex-wrap items-baseline gap-2"},$a={class:"text-xl font-bold text-emerald-600 sm:text-2xl md:text-3xl"},Sa={class:"text-sm font-medium text-green-600"},Aa={class:"text-xs text-gray-500 dark:text-gray-400"},Ra={class:"flex flex-wrap items-center justify-between gap-x-4"},Pa={class:"font-medium"},Ua={class:"font-medium"},Ia={key:0,class:"text-purple-600"},Ba={class:"font-medium"},Ma={key:1,class:"text-purple-600"},Oa={class:"font-medium"},Ka={class:"stat-card"},Fa={class:"flex items-center justify-between"},La={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},za={class:"text-xs text-gray-400"},Na={class:"text-2xl font-bold text-orange-600 sm:text-3xl"},Ha={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ea={key:0,class:"text-yellow-600"},Ga={class:"stat-card"},qa={class:"flex items-center justify-between"},Va={class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"},ja={class:"text-xs text-gray-400"},Ya={class:"text-2xl font-bold text-rose-600 sm:text-3xl"},Wa={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Za={key:0,class:"text-yellow-600"},Qa={class:"mb-8"},Xa={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Ja={class:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-end"},ts={class:"flex flex-shrink-0 gap-1 overflow-x-auto rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},es=["onClick"],as={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},ss={class:"flex items-center gap-2"},os={key:0,class:"text-xs text-orange-600"},ns={class:"flex items-center gap-2"},ls={class:"flex items-center rounded-lg bg-gray-100 px-3 py-1 dark:bg-gray-700"},rs={class:"relative inline-flex cursor-pointer items-center"},is={class:"ml-2.5 flex select-none items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-300"},ds=["disabled"],us={class:"hidden sm:inline"},cs={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ms={class:"card p-4 sm:p-6"},ps={class:"relative",style:{height:"250px"}},ys={class:"card p-4 sm:p-6"},gs={key:0,class:"py-8 text-center"},fs={key:1,class:"max-h-[250px] overflow-auto sm:max-h-[300px]"},xs={class:"min-w-full"},vs={class:"divide-y divide-gray-200 dark:divide-gray-600"},bs={class:"px-2 py-2 text-xs text-gray-900 dark:text-gray-100 sm:px-4 sm:text-sm"},hs=["title"],ks={class:"hidden px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:table-cell sm:px-4 sm:text-sm"},_s={class:"px-2 py-2 text-right text-xs text-gray-600 dark:text-gray-400 sm:px-4 sm:text-sm"},Ds={class:"px-2 py-2 text-right text-xs font-medium text-green-600 sm:px-4 sm:text-sm"},Cs={class:"hidden px-2 py-2 text-right text-xs font-medium sm:table-cell sm:px-4 sm:text-sm"},ws={class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"},Ts={class:"mb-4 sm:mb-6 md:mb-8"},$s={class:"card p-4 sm:p-6"},Ss={class:"sm:h-[300px]",style:{height:"250px"}},As={class:"mb-4 sm:mb-6 md:mb-8"},Rs={class:"card p-4 sm:p-6"},Ps={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Us={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Is={class:"mb-4 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Bs={key:0},Ms={key:1},Os={class:"sm:h-[350px]",style:{height:"300px"}},Ks={class:"mb-4 sm:mb-6 md:mb-8"},Fs={class:"card p-4 sm:p-6"},Ls={class:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},zs={class:"flex flex-col gap-1 sm:flex-row sm:items-center sm:gap-3"},Ns={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-sm"},Hs={class:"flex flex-wrap items-center gap-2"},Es={class:"flex gap-1 rounded-lg bg-gray-100 p-1 dark:bg-gray-700"},Gs=["onClick"],qs={class:"mb-4 flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-400 sm:text-sm"},Vs={key:0},js={key:0,class:"py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Ys={key:1,class:"sm:h-[350px]",style:{height:"300px"}},Ws={__name:"DashboardView",setup(Q){const V=ae(),q=ee(),{isDarkMode:z}=Et(q),{dashboardData:o,groupLimitsSummary:ut,costsData:X,dashboardModelStats:W,trendData:N,apiKeysTrendData:s,accountUsageTrendData:d,accountUsageGroup:P,formattedUptime:J,dateFilter:nt,trendGranularity:tt,apiKeysTrendMetric:_,defaultTime:St}=Et(V),{loadDashboardData:At,loadGroupLimitsSummary:_t,loadApiKeysTrend:Dt,setDateFilterPreset:Ct,onCustomDateRangeChange:ft,setTrendGranularity:et,refreshChartsData:Rt,setAccountUsageGroup:Pt,disabledDate:ct}=V,xt=S(null),lt=S(null),vt=S(null),y=S(null);let n=null,u=null,c=null,l=null;const i=[{value:"claude",label:"Claude"},{value:"openai",label:"OpenAI"},{value:"gemini",label:"Gemini"}],r=S(!1),m=S(!1);async function I(){if(!m.value){m.value=!0;try{await _t(!0)}finally{m.value=!1}}}const w=S(!1),O=S(30),B=S(null),M=S(0),K=S(null),E=S(!1),D=ot(()=>({text:z.value?"#e5e7eb":"#374151",grid:z.value?"rgba(75, 85, 99, 0.3)":"rgba(0, 0, 0, 0.1)",legend:z.value?"#e5e7eb":"#374151"}));function F(b){return b>=1e6?(b/1e6).toFixed(2)+"M":b>=1e3?(b/1e3).toFixed(2)+"K":b.toString()}function Kt(b){return Number.isFinite(b)?b>=1?`$${b.toFixed(2)}`:b>=.01?`$${b.toFixed(3)}`:`$${b.toFixed(6)}`:"$0.000000"}function Ft(b,e){if(!e||e.length===0)return 0;const A=e.reduce((h,Y)=>h+Y.allTokens,0);return A===0?0:(b/A*100).toFixed(1)}function Ut(){if(!xt.value)return;n&&n.destroy();const b=W.value||[],e={labels:b.map(A=>A.model),datasets:[{data:b.map(A=>A.allTokens),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],borderWidth:0}]};n=new $t(xt.value,{type:"doughnut",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,font:{size:12},color:D.value.legend}},tooltip:{callbacks:{label:function(A){const h=A.label||"",Y=F(A.parsed),rt=Ft(A.parsed,b);return`${h}: ${Y} (${rt}%)`}}}}}})}function It(){var v;if(!lt.value)return;u&&u.destroy();const b=N.value||[],e=b.map(g=>g.inputTokens||0),A=b.map(g=>g.outputTokens||0),h=b.map(g=>g.cacheCreateTokens||0),Y=b.map(g=>g.cacheReadTokens||0),rt=b.map(g=>g.requests||0),mt=b.map(g=>g.cost||0),it=(v=b[0])!=null&&v.date?"date":"hour",H={labels:b.map(g=>{if(g.label)return g.label;if(it==="hour"){const k=new Date(g.hour),R=String(k.getMonth()+1).padStart(2,"0"),j=String(k.getDate()).padStart(2,"0"),G=String(k.getHours()).padStart(2,"0");return`${R}/${j} ${G}:00`}const C=g.date;if(C&&C.includes("-")){const k=C.split("-");if(k.length>=3)return`${k[1]}/${k[2]}`}return g.date}),datasets:[{label:"è¾“å…¥Token",data:e,borderColor:"rgb(102, 126, 234)",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.3},{label:"è¾“å‡ºToken",data:A,borderColor:"rgb(240, 147, 251)",backgroundColor:"rgba(240, 147, 251, 0.1)",tension:.3},{label:"ç¼“å­˜åˆ›å»ºToken",data:h,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.3},{label:"ç¼“å­˜è¯»å–Token",data:Y,borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",tension:.3},{label:"è´¹ç”¨ (USD)",data:mt,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.3,yAxisID:"y2"},{label:"è¯·æ±‚æ•°",data:rt,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.3,yAxisID:"y1"}]};u=new $t(lt.value,{type:"line",data:H,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"Tokenä½¿ç”¨è¶‹åŠ¿",font:{size:16,weight:"bold"},color:D.value.text},legend:{position:"top",labels:{color:D.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(g,C){const k=g.dataset.label||"",R=C.dataset.label||"";return k==="è´¹ç”¨ (USD)"||R==="è´¹ç”¨ (USD)"?k==="è´¹ç”¨ (USD)"?-1:1:k==="è¯·æ±‚æ•°"||R==="è¯·æ±‚æ•°"?k==="è¯·æ±‚æ•°"?1:-1:C.parsed.y-g.parsed.y},callbacks:{label:function(g){const C=g.dataset.label||"";let k=g.parsed.y;return C==="è´¹ç”¨ (USD)"?k<.01?C+": $"+k.toFixed(6):C+": $"+k.toFixed(4):C==="è¯·æ±‚æ•°"?C+": "+k.toLocaleString()+" æ¬¡":k>=1e6?C+": "+(k/1e6).toFixed(2)+"M tokens":k>=1e3?C+": "+(k/1e3).toFixed(2)+"K tokens":C+": "+k.toLocaleString()+" tokens"}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:tt==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:D.value.text},ticks:{color:D.value.text},grid:{color:D.value.grid}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Tokenæ•°é‡",color:D.value.text},ticks:{callback:function(g){return F(g)},color:D.value.text},grid:{color:D.value.grid}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"è¯·æ±‚æ•°",color:D.value.text},grid:{drawOnChartArea:!1},ticks:{callback:function(g){return g.toLocaleString()},color:D.value.text}},y2:{type:"linear",display:!1,position:"right"}}}})}function wt(){var mt,it;if(!vt.value)return;c&&c.destroy();const b=s.value.data||[],e=_.value,A=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],h=((mt=s.value.topApiKeys)==null?void 0:mt.map((T,H)=>{var C,k;const v=s.value.data.map(R=>!R.apiKeys||!R.apiKeys[T]?0:e==="tokens"?R.apiKeys[T].tokens:R.apiKeys[T].requests||0);return{label:((k=(C=s.value.data.find(R=>R.apiKeys&&R.apiKeys[T]))==null?void 0:C.apiKeys[T])==null?void 0:k.name)||`API Key ${T}`,data:v,borderColor:A[H%A.length],backgroundColor:A[H%A.length]+"20",tension:.4,fill:!1}}))||[],Y=(it=b[0])!=null&&it.date?"date":"hour",rt={labels:b.map(T=>{if(T.label)return T.label;if(Y==="hour"){const v=new Date(T.hour),g=String(v.getMonth()+1).padStart(2,"0"),C=String(v.getDate()).padStart(2,"0"),k=String(v.getHours()).padStart(2,"0");return`${g}/${C} ${k}:00`}const H=T.date;if(H&&H.includes("-")){const v=H.split("-");if(v.length>=3)return`${v[1]}/${v[2]}`}return T.date}),datasets:h};c=new $t(vt.value,{type:"line",data:rt,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:D.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:function(T,H){return H.parsed.y-T.parsed.y},callbacks:{label:function(T){var G;const H=T.dataset.label||"",v=T.parsed.y,g=T.dataIndex,C=s.value.data[g],R=T.chart.data.datasets.map((L,pt)=>({value:L.data[g]||0,index:pt})).sort((L,pt)=>pt.value-L.value).findIndex(L=>L.index===T.datasetIndex)+1;let j="";if(R===1?j="ğŸ¥‡ ":R===2?j="ğŸ¥ˆ ":R===3&&(j="ğŸ¥‰ "),_.value==="tokens"){let L="";v>=1e6?L=(v/1e6).toFixed(2)+"M":v>=1e3?L=(v/1e3).toFixed(2)+"K":L=v.toLocaleString();const pt=s.value.topApiKeys[T.datasetIndex],dt=(G=C==null?void 0:C.apiKeys)==null?void 0:G[pt],yt=(dt==null?void 0:dt.formattedCost)||"$0.00";return`${j}${H}: ${L} tokens (${yt})`}else return`${j}${H}: ${v.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:tt==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:D.value.text},ticks:{color:D.value.text},grid:{color:D.value.grid}},y:{beginAtZero:!0,title:{display:!0,text:_.value==="tokens"?"Token æ•°é‡":"è¯·æ±‚æ¬¡æ•°",color:D.value.text},ticks:{callback:function(T){return F(T)},color:D.value.text},grid:{color:D.value.grid}}}}})}async function Lt(){await Dt(_.value),await at(),wt()}function Tt(){var it,T,H;if(!y.value)return;l&&l.destroy();const b=((it=d.value)==null?void 0:it.data)||[],e=((T=d.value)==null?void 0:T.topAccounts)||[],A=["#2563EB","#059669","#D97706","#DC2626","#7C3AED","#F472B6","#0EA5E9","#F97316","#6366F1","#22C55E"],h=e.map((v,g)=>{var R,j;const C=b.map(G=>!G.accounts||!G.accounts[v]?0:G.accounts[v].cost||0);return{label:((j=(R=b.find(G=>G.accounts&&G.accounts[v]))==null?void 0:R.accounts[v])==null?void 0:j.name)||`è´¦å· ${String(v).slice(0,6)}`,data:C,borderColor:A[g%A.length],backgroundColor:A[g%A.length]+"20",tension:.4,fill:!1}}),Y=(H=b[0])!=null&&H.date?"date":"hour",rt={labels:b.map(v=>{if(v.label)return v.label;if(Y==="hour"){const g=new Date(v.hour),C=String(g.getMonth()+1).padStart(2,"0"),k=String(g.getDate()).padStart(2,"0"),R=String(g.getHours()).padStart(2,"0");return`${C}/${k} ${R}:00`}if(v.date&&v.date.includes("-")){const g=v.date.split("-");if(g.length>=3)return`${g[1]}/${g[2]}`}return v.date}),datasets:h},mt=e;l=new $t(y.value,{type:"line",data:rt,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:12},color:D.value.legend}},tooltip:{mode:"index",intersect:!1,itemSort:(v,g)=>g.parsed.y-v.parsed.y,callbacks:{label:function(v){var Ht;const g=v.dataset.label||"",C=v.parsed.y||0,k=v.dataIndex,R=v.datasetIndex,j=mt[R],G=d.value.data[k],L=(Ht=G==null?void 0:G.accounts)==null?void 0:Ht[j],dt=v.chart.data.datasets.map((bt,Mt)=>({value:bt.data[k]||0,index:Mt})).sort((bt,Mt)=>Mt.value-bt.value).findIndex(bt=>bt.index===R)+1;let yt="";dt===1?yt="ğŸ¥‡ ":dt===2?yt="ğŸ¥ˆ ":dt===3&&(yt="ğŸ¥‰ ");const Vt=(L==null?void 0:L.formattedCost)||Kt(C),jt=(L==null?void 0:L.requests)||0;return`${yt}${g}: ${Vt} / ${jt.toLocaleString()} æ¬¡`}}}},scales:{x:{type:"category",display:!0,title:{display:!0,text:tt.value==="hour"?"æ—¶é—´":"æ—¥æœŸ",color:D.value.text},ticks:{color:D.value.text},grid:{color:D.value.grid}},y:{beginAtZero:!0,title:{display:!0,text:"æ¶ˆè€—é‡‘é¢ (USD)",color:D.value.text},ticks:{callback:v=>Kt(Number(v)),color:D.value.text},grid:{color:D.value.grid}}}}})}async function qt(b){if(!(P.value===b||r.value)){r.value=!0;try{await Pt(b),await at(),Tt()}finally{r.value=!1}}}gt(W,()=>{at(()=>Ut())}),gt(N,()=>{at(()=>It())}),gt(s,()=>{at(()=>wt())}),gt(d,()=>{at(()=>Tt())});async function Bt(){if(!E.value){E.value=!0;try{await Promise.all([At(),Rt()])}finally{E.value=!1}}}function zt(){w.value&&(M.value=O.value,K.value&&clearInterval(K.value),B.value&&clearTimeout(B.value),K.value=setInterval(()=>{M.value--,M.value<=0&&clearInterval(K.value)},1e3),B.value=setTimeout(async()=>{await Bt(),w.value&&zt()},O.value*1e3))}function Nt(){K.value&&(clearInterval(K.value),K.value=null),B.value&&(clearTimeout(B.value),B.value=null),M.value=0}return gt(w,b=>{b?zt():Nt()}),gt(z,()=>{at(()=>{Ut(),It(),wt(),Tt()})}),Zt(async()=>{await Bt(),await at(),Ut(),It(),wt(),Tt()}),Qt(()=>{Nt(),n&&n.destroy(),u&&u.destroy(),c&&c.destroy(),l&&l.destroy()}),(b,e)=>{const A=Yt;return x(),f("div",null,[Gt(Ce,{limits:a(ut),refreshing:m.value,onRefresh:I},null,8,["limits","refreshing"]),t("div",we,[t("div",Te,[t("div",$e,[t("div",null,[e[7]||(e[7]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»API Keys ",-1)),t("p",Se,p(a(o).totalApiKeys),1),t("p",Ae," æ´»è·ƒ: "+p(a(o).activeApiKeys||0),1)]),e[8]||(e[8]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-key"})],-1))])]),t("div",Re,[t("div",Pe,[t("div",Ue,[e[16]||(e[16]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æœåŠ¡è´¦æˆ· ",-1)),t("div",Ie,[t("p",Be,p(a(o).totalAccounts),1),a(o).accountsByPlatform?(x(),f("div",Me,[a(o).accountsByPlatform.claude&&a(o).accountsByPlatform.claude.total>0?(x(),f("div",{key:0,class:"inline-flex items-center gap-0.5",title:`Claude: ${a(o).accountsByPlatform.claude.total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform.claude.normal})`},[e[9]||(e[9]=t("i",{class:"fas fa-brain text-xs text-indigo-600"},null,-1)),t("span",Ke,p(a(o).accountsByPlatform.claude.total),1)],8,Oe)):$("",!0),a(o).accountsByPlatform["claude-console"]&&a(o).accountsByPlatform["claude-console"].total>0?(x(),f("div",{key:1,class:"inline-flex items-center gap-0.5",title:`Console: ${a(o).accountsByPlatform["claude-console"].total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform["claude-console"].normal})`},[e[10]||(e[10]=t("i",{class:"fas fa-terminal text-xs text-purple-600"},null,-1)),t("span",Le,p(a(o).accountsByPlatform["claude-console"].total),1)],8,Fe)):$("",!0),a(o).accountsByPlatform.gemini&&a(o).accountsByPlatform.gemini.total>0?(x(),f("div",{key:2,class:"inline-flex items-center gap-0.5",title:`Gemini: ${a(o).accountsByPlatform.gemini.total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform.gemini.normal})`},[e[11]||(e[11]=t("i",{class:"fas fa-robot text-xs text-yellow-600"},null,-1)),t("span",Ne,p(a(o).accountsByPlatform.gemini.total),1)],8,ze)):$("",!0),a(o).accountsByPlatform.bedrock&&a(o).accountsByPlatform.bedrock.total>0?(x(),f("div",{key:3,class:"inline-flex items-center gap-0.5",title:`Bedrock: ${a(o).accountsByPlatform.bedrock.total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform.bedrock.normal})`},[e[12]||(e[12]=t("i",{class:"fab fa-aws text-xs text-orange-600"},null,-1)),t("span",Ee,p(a(o).accountsByPlatform.bedrock.total),1)],8,He)):$("",!0),a(o).accountsByPlatform.openai&&a(o).accountsByPlatform.openai.total>0?(x(),f("div",{key:4,class:"inline-flex items-center gap-0.5",title:`OpenAI: ${a(o).accountsByPlatform.openai.total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform.openai.normal})`},[e[13]||(e[13]=t("i",{class:"fas fa-openai text-xs text-gray-100"},null,-1)),t("span",qe,p(a(o).accountsByPlatform.openai.total),1)],8,Ge)):$("",!0),a(o).accountsByPlatform.azure_openai&&a(o).accountsByPlatform.azure_openai.total>0?(x(),f("div",{key:5,class:"inline-flex items-center gap-0.5",title:`Azure OpenAI: ${a(o).accountsByPlatform.azure_openai.total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform.azure_openai.normal})`},[e[14]||(e[14]=t("i",{class:"fab fa-microsoft text-xs text-blue-600"},null,-1)),t("span",je,p(a(o).accountsByPlatform.azure_openai.total),1)],8,Ve)):$("",!0),a(o).accountsByPlatform["openai-responses"]&&a(o).accountsByPlatform["openai-responses"].total>0?(x(),f("div",{key:6,class:"inline-flex items-center gap-0.5",title:`OpenAI Responses: ${a(o).accountsByPlatform["openai-responses"].total} ä¸ª (æ­£å¸¸: ${a(o).accountsByPlatform["openai-responses"].normal})`},[e[15]||(e[15]=t("i",{class:"fas fa-server text-xs text-cyan-600"},null,-1)),t("span",We,p(a(o).accountsByPlatform["openai-responses"].total),1)],8,Ye)):$("",!0)])):$("",!0)]),t("p",Ze,[U(" æ­£å¸¸: "+p(a(o).normalAccounts||0)+" ",1),a(o).abnormalAccounts>0?(x(),f("span",Qe," | å¼‚å¸¸: "+p(a(o).abnormalAccounts),1)):$("",!0),a(o).pausedAccounts>0?(x(),f("span",Xe," | åœæ­¢è°ƒåº¦: "+p(a(o).pausedAccounts),1)):$("",!0),a(o).rateLimitedAccounts>0?(x(),f("span",Je," | é™æµ: "+p(a(o).rateLimitedAccounts),1)):$("",!0)])]),e[17]||(e[17]=t("div",{class:"stat-icon ml-2 flex-shrink-0 bg-gradient-to-br from-green-500 to-green-600"},[t("i",{class:"fas fa-user-circle"})],-1))])]),t("div",ta,[t("div",ea,[t("div",null,[e[18]||(e[18]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥è¯·æ±‚ ",-1)),t("p",aa,p(a(o).todayRequests),1),t("p",sa," æ€»è¯·æ±‚: "+p(F(a(o).totalRequests||0)),1)]),e[19]||(e[19]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-chart-line"})],-1))])]),t("div",oa,[t("div",na,[t("div",null,[e[20]||(e[20]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ç³»ç»ŸçŠ¶æ€ ",-1)),t("p",la,p(a(o).systemStatus),1),t("p",ra," è¿è¡Œæ—¶é—´: "+p(a(J)),1)]),e[21]||(e[21]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-yellow-500 to-orange-500"},[t("i",{class:"fas fa-heartbeat"})],-1))])])]),t("div",ia,[t("div",da,[t("div",ua,[t("div",ca,[e[26]||(e[26]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," ä»Šæ—¥Token ",-1)),t("div",ma,[t("p",pa,p(F((a(o).todayInputTokens||0)+(a(o).todayOutputTokens||0)+(a(o).todayCacheCreateTokens||0)+(a(o).todayCacheReadTokens||0))),1),t("span",ya,"/ "+p(a(X).todayCosts.formatted.totalCost),1)]),t("div",ga,[t("div",fa,[t("span",null,[e[22]||(e[22]=U("è¾“å…¥: ",-1)),t("span",xa,p(F(a(o).todayInputTokens||0)),1)]),t("span",null,[e[23]||(e[23]=U("è¾“å‡º: ",-1)),t("span",va,p(F(a(o).todayOutputTokens||0)),1)]),(a(o).todayCacheCreateTokens||0)>0?(x(),f("span",ba,[e[24]||(e[24]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",ha,p(F(a(o).todayCacheCreateTokens||0)),1)])):$("",!0),(a(o).todayCacheReadTokens||0)>0?(x(),f("span",ka,[e[25]||(e[25]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",_a,p(F(a(o).todayCacheReadTokens||0)),1)])):$("",!0)])])]),e[27]||(e[27]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-indigo-500 to-indigo-600"},[t("i",{class:"fas fa-coins"})],-1))])]),t("div",Da,[t("div",Ca,[t("div",wa,[e[32]||(e[32]=t("p",{class:"mb-1 text-xs font-semibold text-gray-600 dark:text-gray-400 sm:text-sm"}," æ€»Tokenæ¶ˆè€— ",-1)),t("div",Ta,[t("p",$a,p(F((a(o).totalInputTokens||0)+(a(o).totalOutputTokens||0)+(a(o).totalCacheCreateTokens||0)+(a(o).totalCacheReadTokens||0))),1),t("span",Sa,"/ "+p(a(X).totalCosts.formatted.totalCost),1)]),t("div",Aa,[t("div",Ra,[t("span",null,[e[28]||(e[28]=U("è¾“å…¥: ",-1)),t("span",Pa,p(F(a(o).totalInputTokens||0)),1)]),t("span",null,[e[29]||(e[29]=U("è¾“å‡º: ",-1)),t("span",Ua,p(F(a(o).totalOutputTokens||0)),1)]),(a(o).totalCacheCreateTokens||0)>0?(x(),f("span",Ia,[e[30]||(e[30]=U("ç¼“å­˜åˆ›å»º: ",-1)),t("span",Ba,p(F(a(o).totalCacheCreateTokens||0)),1)])):$("",!0),(a(o).totalCacheReadTokens||0)>0?(x(),f("span",Ma,[e[31]||(e[31]=U("ç¼“å­˜è¯»å–: ",-1)),t("span",Oa,p(F(a(o).totalCacheReadTokens||0)),1)])):$("",!0)])])]),e[33]||(e[33]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-emerald-500 to-emerald-600"},[t("i",{class:"fas fa-database"})],-1))])]),t("div",Ka,[t("div",Fa,[t("div",null,[t("p",La,[e[34]||(e[34]=U(" å®æ—¶RPM ",-1)),t("span",za,"("+p(a(o).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",Na,p(a(o).realtimeRPM||0),1),t("p",Ha,[e[36]||(e[36]=U(" æ¯åˆ†é’Ÿè¯·æ±‚æ•° ",-1)),a(o).isHistoricalMetrics?(x(),f("span",Ea,e[35]||(e[35]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):$("",!0)])]),e[37]||(e[37]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-orange-500 to-orange-600"},[t("i",{class:"fas fa-tachometer-alt"})],-1))])]),t("div",Ga,[t("div",qa,[t("div",null,[t("p",Va,[e[38]||(e[38]=U(" å®æ—¶TPM ",-1)),t("span",ja,"("+p(a(o).metricsWindow)+"åˆ†é’Ÿ)",1)]),t("p",Ya,p(F(a(o).realtimeTPM||0)),1),t("p",Wa,[e[40]||(e[40]=U(" æ¯åˆ†é’ŸTokenæ•° ",-1)),a(o).isHistoricalMetrics?(x(),f("span",Za,e[39]||(e[39]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" å†å²æ•°æ® ",-1)]))):$("",!0)])]),e[41]||(e[41]=t("div",{class:"stat-icon flex-shrink-0 bg-gradient-to-br from-rose-500 to-rose-600"},[t("i",{class:"fas fa-rocket"})],-1))])])]),t("div",Qa,[t("div",Xa,[e[48]||(e[48]=t("h3",{class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"}," æ¨¡å‹ä½¿ç”¨åˆ†å¸ƒä¸Tokenä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",Ja,[t("div",ts,[(x(!0),f(ht,null,kt(a(nt).presetOptions,h=>(x(),f("button",{key:h.value,class:st(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(nt).preset===h.value&&a(nt).type==="preset"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:Y=>a(Ct)(h.value)},p(h.label),11,es))),128))]),t("div",as,[t("button",{class:st(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(tt)==="day"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[0]||(e[0]=h=>a(et)("day"))},e[42]||(e[42]=[t("i",{class:"fas fa-calendar-day mr-1"},null,-1),U("æŒ‰å¤© ",-1)]),2),t("button",{class:st(["rounded-md px-3 py-1 text-sm font-medium transition-colors",a(tt)==="hour"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[1]||(e[1]=h=>a(et)("hour"))},e[43]||(e[43]=[t("i",{class:"fas fa-clock mr-1"},null,-1),U("æŒ‰å°æ—¶ ",-1)]),2)]),t("div",ss,[Gt(A,{modelValue:a(nt).customRange,"onUpdate:modelValue":e[2]||(e[2]=h=>a(nt).customRange=h),class:"custom-date-picker w-full lg:w-auto","default-time":a(St),"disabled-date":a(ct),"end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD HH:mm:ss","range-separator":"è‡³",size:"default","start-placeholder":"å¼€å§‹æ—¥æœŸ",style:{"max-width":"400px"},type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:a(ft)},null,8,["modelValue","default-time","disabled-date","onChange"]),a(tt)==="hour"?(x(),f("span",os,e[44]||(e[44]=[t("i",{class:"fas fa-info-circle"},null,-1),U(" æœ€å¤š24å°æ—¶ ",-1)]))):$("",!0)]),t("div",ns,[t("div",ls,[t("label",rs,[Xt(t("input",{"onUpdate:modelValue":e[3]||(e[3]=h=>w.value=h),class:"peer sr-only",type:"checkbox"},null,512),[[Jt,w.value]]),e[47]||(e[47]=t("div",{class:"peer relative h-5 w-9 rounded-full bg-gray-300 transition-all duration-200 after:absolute after:left-[2px] after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white after:shadow-sm after:transition-transform after:duration-200 after:content-[''] peer-checked:bg-blue-500 peer-checked:after:translate-x-4 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:bg-gray-600 dark:after:bg-gray-300 dark:peer-focus:ring-blue-600"},null,-1)),t("span",is,[e[45]||(e[45]=t("i",{class:"fas fa-redo-alt text-xs text-gray-500 dark:text-gray-400"},null,-1)),e[46]||(e[46]=t("span",null,"è‡ªåŠ¨åˆ·æ–°",-1)),w.value?(x(),f("span",{key:0,class:st(["ml-1 font-mono text-xs text-blue-600 transition-opacity",M.value>0?"opacity-100":"opacity-0"])},p(M.value)+"s ",3)):$("",!0)])])]),t("button",{class:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1 text-sm font-medium text-blue-600 shadow-sm transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 sm:gap-2",disabled:E.value,title:"ç«‹å³åˆ·æ–°æ•°æ®",onClick:e[4]||(e[4]=h=>Bt())},[t("i",{class:st(["fas fa-sync-alt text-xs",{"animate-spin":E.value}])},null,2),t("span",us,p(E.value?"åˆ·æ–°ä¸­":"åˆ·æ–°"),1)],8,ds)])])]),t("div",cs,[t("div",ms,[e[49]||(e[49]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," Tokenä½¿ç”¨åˆ†å¸ƒ ",-1)),t("div",ps,[t("canvas",{ref_key:"modelUsageChart",ref:xt},null,512)])]),t("div",ys,[e[52]||(e[52]=t("h4",{class:"mb-4 text-base font-semibold text-gray-800 dark:text-gray-200 sm:text-lg"}," è¯¦ç»†ç»Ÿè®¡æ•°æ® ",-1)),a(W).length===0?(x(),f("div",gs,e[50]||(e[50]=[t("p",{class:"text-sm text-gray-500 sm:text-base"},"æš‚æ— æ¨¡å‹ä½¿ç”¨æ•°æ®",-1)]))):(x(),f("div",fs,[t("table",xs,[e[51]||(e[51]=t("thead",{class:"sticky top-0 bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ¨¡å‹ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," è¯·æ±‚æ•° "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," æ€»Token "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:px-4"}," è´¹ç”¨ "),t("th",{class:"hidden px-2 py-2 text-right text-xs font-medium text-gray-700 dark:text-gray-300 sm:table-cell sm:px-4"}," å æ¯” ")])],-1)),t("tbody",vs,[(x(!0),f(ht,null,kt(a(W),h=>(x(),f("tr",{key:h.model,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",bs,[t("span",{class:"block max-w-[100px] truncate sm:max-w-none",title:h.model},p(h.model),9,hs)]),t("td",ks,p(F(h.requests)),1),t("td",_s,p(F(h.allTokens)),1),t("td",Ds,p(h.formatted?h.formatted.total:"$0.000000"),1),t("td",Cs,[t("span",ws,p(Ft(h.allTokens,a(W)))+"% ",1)])]))),128))])])]))])])]),t("div",Ts,[t("div",$s,[t("div",Ss,[t("canvas",{ref_key:"usageTrendChart",ref:lt},null,512)])])]),t("div",As,[t("div",Rs,[t("div",Ps,[e[55]||(e[55]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," API Keys ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("div",Us,[t("button",{class:st(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(_)==="requests"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[5]||(e[5]=h=>(_.value="requests",Lt()))},e[53]||(e[53]=[t("i",{class:"fas fa-exchange-alt mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"è¯·æ±‚æ¬¡æ•°",-1),t("span",{class:"sm:hidden"},"è¯·æ±‚",-1)]),2),t("button",{class:st(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(_)==="tokens"?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:e[6]||(e[6]=h=>(_.value="tokens",Lt()))},e[54]||(e[54]=[t("i",{class:"fas fa-coins mr-1"},null,-1),t("span",{class:"hidden sm:inline"},"Token æ•°é‡",-1),t("span",{class:"sm:hidden"},"Token",-1)]),2)])]),t("div",Is,[a(s).totalApiKeys>10?(x(),f("span",Bs," å…± "+p(a(s).totalApiKeys)+" ä¸ª API Keyï¼Œæ˜¾ç¤ºä½¿ç”¨é‡å‰ 10 ä¸ª ",1)):(x(),f("span",Ms," å…± "+p(a(s).totalApiKeys)+" ä¸ª API Key ",1))]),t("div",Os,[t("canvas",{ref_key:"apiKeysUsageTrendChart",ref:vt},null,512)])])]),t("div",Ks,[t("div",Fs,[t("div",Ls,[t("div",zs,[e[56]||(e[56]=t("h3",{class:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg"}," è´¦å·ä½¿ç”¨è¶‹åŠ¿ ",-1)),t("span",Ns," å½“å‰åˆ†ç»„ï¼š"+p(a(d).groupLabel||"æœªé€‰æ‹©"),1)]),t("div",Hs,[t("div",Es,[(x(),f(ht,null,kt(i,h=>t("button",{key:h.value,class:st(["rounded-md px-2 py-1 text-xs font-medium transition-colors sm:px-3 sm:text-sm",a(P)===h.value?"bg-white text-blue-600 shadow-sm dark:bg-gray-800":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"]),onClick:Y=>qt(h.value)},p(h.label),11,Gs)),64))])])]),t("div",qs,[t("span",null,"å…± "+p(a(d).totalAccounts||0)+" ä¸ªè´¦å·",1),a(d).topAccounts&&a(d).topAccounts.length?(x(),f("span",Vs," æ˜¾ç¤ºæ¶ˆè€—æ’åå‰ "+p(a(d).topAccounts.length)+" ä¸ªè´¦å· ",1)):$("",!0)]),!a(d).data||a(d).data.length===0?(x(),f("div",js," æš‚æ— è´¦å·ä½¿ç”¨æ•°æ® ")):(x(),f("div",Ys,[t("canvas",{ref_key:"accountUsageTrendChart",ref:y},null,512)]))])])])}}},eo=te(Ws,[["__scopeId","data-v-6e3ebd47"]]);export{eo as default};
